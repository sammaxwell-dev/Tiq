# PRD: GPT Translate Helper  
Браузерное расширение для быстрого перевода текста через OpenAI ChatGPT 5

## 1. Обзор продукта

**Название (рабочее)**: Tippr  
**Тип продукта**: WebExtensions браузерное расширение  
**Описание**: Инструмент для мгновенного интеллектуального перевода выделенного текста прямо в браузере. После выделения появляется иконка. По клику открывается переносимое модальное окно с переводом. Перевод выполняется через OpenAI.

---

## 2. Цели и ценность продукта

- Уменьшить трение при переводе текста в браузере.
- Позволить делать более продвинутые переводы и упрощения благодаря ChatGPT.
- Обеспечить максимально гибкие настройки поведения.
- Гарантировать аккуратную интеграцию в страницы и отсутствие конфликтов со стилями.

---

## 3. Целевая аудитория

- Разработчики, читающие англоязычную документацию.
- Студенты и ученики, работающие с иностранными текстами.
- Пользователи, которые часто переводят статьи, письма, посты.

---

## 4. Пользовательские сценарии

1. Пользователь выделяет текст. Появляется иконка. Клик приводит к открытию модального окна с переводом.
2. Пользователь дважды кликает по слову. Получает объяснение простым языком.
3. Пользователь открывает popup расширения и вручную вводит текст для перевода.
4. Пользователь настраивает поведение расширения под свои привычки.

---

## 5. Функциональные требования

### 5.1. Иконка при выделении текста

- Показывать иконку в одном из режимов:
  - Всегда при выделении.
  - Только при двойном клике.
  - Только по горячей клавише.
- Позиция иконки:
  - Справа от выделения.
  - Над выделением.
  - С пользовательским отступом.
- Переключатель: "Включено / Выключено на этом сайте".
- Хранение списка исключений по доменам.

### 5.2. Модальное окно

Функции модалки:

- Перетаскивание по экрану.
- Автоопределение исходного языка.
- Возможность вручную указать исходный язык.
- Выбор языка перевода.
- Кнопка "Поменять местами" (swap).
- Поле исходного текста (редактируемое).
- Поле результата.
- Кнопки:
  - "Перевести" / "Обновить".
  - "Скопировать перевод".
  - "Скопировать исходный и перевод".
- Режимы:
  - Обычный перевод.
  - Перевод с упрощением (объяснение как ребенку).
- Закрытие:
  - Кнопка "Закрыть".
  - По Esc.
  - При клике вне модалки (опционально).
- Настройки отображения:
  - Размер шрифта.
  - Светлая или темная тема.
- Доступность:
  - Фокус на первую важную кнопку.
  - Полноценная клавиатурная навигация.

### 5.3. Popup расширения

- Поле для ввода текста.
- Выбор исходного и целевого языков.
- Выбор режима перевода.
- Кнопка "Перевести".
- Отображение результата.
- Индикация загрузки.

### 5.4. Страница настроек

Секции настроек:

1. **Общие**
   - Язык интерфейса.
   - Язык перевода по умолчанию.
   - Правила перевода:
     - Если исходный русский, переводить на английский.
     - Иначе на русский.

2. **Иконка**
   - Режим показа.
   - Позиция иконки.
   - Список исключений по доменам.

3. **Горячие клавиши**
   - Открыть модалку для выделенного текста.
   - Открыть popup.

4. **OpenAI**
   - Поле для API ключа.
   - Проверка валидности ключа.
   - Хранение ключа в chrome.storage.
   - Настройки модели и лимита токенов.
   - Режим экономии токенов.

---

## 6. Интеграция с OpenAI

- Все запросы выполняются в background/service worker.
- Формирование промпта:
  - Исходный текст.
  - Режим.
  - Язык перевода.
- Обработка ответов и передача данных контент скриптам.

---

## 7. Обработка ошибок и статусов

Обязательные сценарии:

- Ошибка сети:
  - Сообщение "Не удалось связаться с сервером".
  - Кнопка "Повторить".
- Неверный API ключ:
  - Сообщение "Проблема с API ключом".
  - Кнопка "Открыть настройки".
- Превышение лимитов:
  - Сообщение "Лимиты OpenAI превышены".
- Индикатор состояния:
  - "Запрашиваем перевод..." пока идет запрос.
- Логирование ошибок:
  - Только техническая информация без пользовательского текста.
- Повтор запроса:
  - Кнопка "Повторить запрос".

---

## 8. Доступность

- Поддержка клавиатурного управления.
- ARIA разметка для модалки:
  - role="dialog"
  - aria-modal="true"
- Контрастные цвета.
- Фокус на первую важную кнопку.

---

## 9. Встраивание в страницы

- Уникальные префиксы классов: gpt-translator-*.
- Желательно использовать Shadow DOM для модалки и иконки.
- Никакого влияния на layout страницы.
- Минимальная инъекция CSS.

---

## 10. Нефункциональные требования

- Производительность:
  - Минимальная нагрузка на страницу.
  - Оптимизация событий выделения.
- Безопасность:
  - Не отправлять лишние данные в OpenAI.
  - API ключ не хранить в открытом виде.
- Кросс браузерность:
  - Старт: Chrome.
  - Возможная поддержка Firefox и Edge.

---

## 11. MVP

В первую версию входят:

- Выделение → иконка → модалка с переводом.
- Автоопределение исходного языка.
- Редактируемые поля текста.
- Перевод на заранее выбранный язык.
- Ввод API ключа.
- Основные ошибки (сеть, ключ).
- Popup для ручного ввода.

---

## 12. Позднейшие версии

- Режимы объяснения, перефразирования.
- Настройки показа иконки.
- История переводов.
- Переключение тем.
- Гибкие правила перевода.
- Поддержка SidePanel в Chrome.